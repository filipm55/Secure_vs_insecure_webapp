
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security App</title>
    <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
    <% if(user) { %>
        <div class="card">
            <p class="welcome">Welcome, <%= user %>!</p>

            <label class="checkbox-label">
                <input type="checkbox" id="checkbox1" name="check" value="vulnerability1">
                Enable SQL injection
            </label>

            <h3>Please enter your JMBAG to fetch your data:</h3>
            <form id="studentInfoForm" method="POST" onsubmit="return validateJMBAGInput(event)">
                <input type="text" name="jmbag" placeholder="JMBAG" required>
                <button type="submit">Submit</button>
                <p class="error-message" id="jmbagError"></p>
            </form>

            <% if (userData && userData.length > 0) { %>
                <table>
                    <tr>
                        <th>JMBAG</th>
                        <th>Name</th>
                        <th>Surname</th>
                        <th>OIB</th>
                        <th>Age</th>
                    </tr>
                    <% userData.forEach(student => { %>
                        <tr>
                            <td><%= student.jmbag %></td>
                            <td><%= student.name %></td>
                            <td><%= student.surname %></td>
                            <td><%= student.oib %></td>
                            <td><%= student.age %></td>
                        </tr>
                    <% }) %>
                </table>
            <% } %>
            <% if (SQLerror) { %>
                <p class="error-message"><%= SQLerror %></p>
            <% } %>

            <form action="/logout" method="POST">
                <button type="submit" class="logout-btn">Logout</button>
            </form>
        </div>
    <% } else { %>
        <div class="card">
            <label class="checkbox-label">
                <input type="checkbox" id="checkbox2" name="check2" value="vulnerability2">
                Enable broken authentication
            </label>

            <h3>Please login:</h3>
            <form id="loginForm" method="POST" onsubmit="return setLoginAction(event)">
                <input type="text" name="username" placeholder="Username" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>

            <% if (loginError) { %>
                <p class="error-message"><%= loginError %></p>
            <% } %>
        </div>
    <% } %>

    <script src="/scripts/formValidation.js"></script>
</body>
</html>
